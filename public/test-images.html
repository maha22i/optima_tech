<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Images - Adalink</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f5f5f5; 
            line-height: 1.6;
        }
        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section { 
            margin: 30px 0; 
            padding: 20px; 
            border: 2px solid #ddd; 
            border-radius: 8px; 
        }
        .success { 
            border-color: #4CAF50; 
            background: #f8fff8; 
        }
        .error { 
            border-color: #f44336; 
            background: #fff8f8; 
        }
        .warning { 
            border-color: #ff9800; 
            background: #fff8f0; 
        }
        img { 
            max-width: 150px; 
            height: auto; 
            margin: 10px; 
            border: 2px solid #ddd;
            border-radius: 4px;
        }
        .img-loaded { 
            border-color: #4CAF50; 
        }
        .img-error { 
            border-color: #f44336; 
        }
        .test-url { 
            font-family: monospace; 
            background: #f0f0f0; 
            padding: 8px; 
            border-radius: 4px; 
            display: inline-block;
            margin: 5px 0;
            word-break: break-all;
        }
        .status { 
            font-weight: bold; 
            padding: 5px 10px; 
            border-radius: 4px; 
            display: inline-block;
            margin-left: 10px;
        }
        .status.success { 
            background: #4CAF50; 
            color: white; 
        }
        .status.error { 
            background: #f44336; 
            color: white; 
        }
        .debug-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üñºÔ∏è Test des Images - Adalink</h1>
        <p><strong>Cette page teste tous les types d'acc√®s aux images du site.</strong></p>
        
        <div class="debug-info">
            <strong>Debug Info:</strong><br>
            URL actuelle: <span id="current-url"></span><br>
            User Agent: <span id="user-agent"></span><br>
            Timestamp: <span id="timestamp"></span>
        </div>
        
        <div class="test-section">
            <h3>üñºÔ∏è Test 1: Images du dossier public</h3>
            <div>
                <h4>Logo Principal</h4>
                <div class="test-url">./logo.png</div>
                <img src="./logo.png" alt="Logo" id="logo-main" data-src="./logo.png">
                <span class="status" id="status-logo-main">‚è≥ Test...</span>
            </div>
            
            <div>
                <h4>Logo Sans Fond</h4>
                <div class="test-url">./logo-removebg.png</div>
                <img src="./logo-removebg.png" alt="Logo sans fond" id="logo-nobg" data-src="./logo-removebg.png">
                <span class="status" id="status-logo-nobg">‚è≥ Test...</span>
            </div>
            
            <div>
                <h4>Favicon</h4>
                <div class="test-url">./favicon.ico</div>
                <img src="./favicon.ico" alt="Favicon" id="favicon" data-src="./favicon.ico">
                <span class="status" id="status-favicon">‚è≥ Test...</span>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üåê Test 2: Acc√®s direct avec fetch</h3>
            <div id="fetch-results"></div>
        </div>
        
        <div class="test-section">
            <h3>üîß Test 3: URLs absolues</h3>
            <div>
                <h4>Logo avec URL absolue</h4>
                <div class="test-url" id="absolute-url"></div>
                <img id="logo-absolute" alt="Logo absolu">
                <span class="status" id="status-logo-absolute">‚è≥ Test...</span>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üìù Test 4: Headers et informations serveur</h3>
            <div id="server-info"></div>
        </div>
        
        <div class="test-section" id="results-summary">
            <h3>üìä R√©sum√© des Tests</h3>
            <div id="summary-content"></div>
        </div>
    </div>
    
    <script>
        // Variables globales pour le suivi
        const testResults = {
            images: {},
            fetch: {},
            server: {}
        };
        
        // Informations de debug
        document.getElementById('current-url').textContent = window.location.href;
        document.getElementById('user-agent').textContent = navigator.userAgent;
        document.getElementById('timestamp').textContent = new Date().toISOString();
        
        // Test 1: Images avec √©v√©nements de chargement
        function setupImageTest(imgId, statusId) {
            const img = document.getElementById(imgId);
            const status = document.getElementById(statusId);
            const src = img.getAttribute('data-src');
            
            img.onload = function() {
                img.classList.add('img-loaded');
                status.textContent = '‚úÖ OK';
                status.className = 'status success';
                testResults.images[imgId] = { status: 'success', src: src };
                updateSummary();
            };
            
            img.onerror = function() {
                img.classList.add('img-error');
                status.textContent = '‚ùå ERREUR';
                status.className = 'status error';
                testResults.images[imgId] = { status: 'error', src: src };
                updateSummary();
            };
        }
        
        // Configuration des tests d'images
        setupImageTest('logo-main', 'status-logo-main');
        setupImageTest('logo-nobg', 'status-logo-nobg');
        setupImageTest('favicon', 'status-favicon');
        
        // Test 2: Fetch API
        function testFetch() {
            const images = ['./logo.png', './logo-removebg.png', './favicon.ico', './manifest.json'];
            const resultsDiv = document.getElementById('fetch-results');
            
            images.forEach(async (src) => {
                try {
                    const response = await fetch(src);
                    const resultDiv = document.createElement('div');
                    resultDiv.style.margin = '10px 0';
                    
                    if (response.ok) {
                        resultDiv.innerHTML = `‚úÖ <strong>${src}</strong> - Status: ${response.status} - Type: ${response.headers.get('content-type')}`;
                        testResults.fetch[src] = { status: 'success', code: response.status, type: response.headers.get('content-type') };
                    } else {
                        resultDiv.innerHTML = `‚ùå <strong>${src}</strong> - Status: ${response.status}`;
                        testResults.fetch[src] = { status: 'error', code: response.status };
                    }
                    resultsDiv.appendChild(resultDiv);
                } catch (error) {
                    const resultDiv = document.createElement('div');
                    resultDiv.style.margin = '10px 0';
                    resultDiv.innerHTML = `‚ùå <strong>${src}</strong> - Erreur: ${error.message}`;
                    resultsDiv.appendChild(resultDiv);
                    testResults.fetch[src] = { status: 'error', error: error.message };
                }
                updateSummary();
            });
        }
        
        // Test 3: URL absolue
        function testAbsoluteURL() {
            const baseUrl = window.location.origin;
            const absoluteUrl = baseUrl + '/logo.png';
            
            document.getElementById('absolute-url').textContent = absoluteUrl;
            
            const img = document.getElementById('logo-absolute');
            const status = document.getElementById('status-logo-absolute');
            
            img.src = absoluteUrl;
            
            img.onload = function() {
                img.classList.add('img-loaded');
                status.textContent = '‚úÖ OK';
                status.className = 'status success';
                testResults.images['logo-absolute'] = { status: 'success', src: absoluteUrl };
                updateSummary();
            };
            
            img.onerror = function() {
                img.classList.add('img-error');
                status.textContent = '‚ùå ERREUR';
                status.className = 'status error';
                testResults.images['logo-absolute'] = { status: 'error', src: absoluteUrl };
                updateSummary();
            };
        }
        
        // Test 4: Informations serveur
        async function testServerInfo() {
            const serverInfoDiv = document.getElementById('server-info');
            
            try {
                const response = await fetch('./logo.png', { method: 'HEAD' });
                const headers = {};
                for (let [key, value] of response.headers.entries()) {
                    headers[key] = value;
                }
                
                serverInfoDiv.innerHTML = `
                    <strong>Headers de r√©ponse pour logo.png:</strong><br>
                    <div class="debug-info">
                        Status: ${response.status}<br>
                        ${Object.entries(headers).map(([key, value]) => `${key}: ${value}`).join('<br>')}
                    </div>
                `;
                
                testResults.server = { status: response.status, headers: headers };
            } catch (error) {
                serverInfoDiv.innerHTML = `<div class="debug-info">Erreur: ${error.message}</div>`;
                testResults.server = { error: error.message };
            }
        }
        
        // Mise √† jour du r√©sum√©
        function updateSummary() {
            const summaryDiv = document.getElementById('summary-content');
            const totalTests = Object.keys(testResults.images).length + Object.keys(testResults.fetch).length;
            const successCount = Object.values(testResults.images).filter(r => r.status === 'success').length + 
                               Object.values(testResults.fetch).filter(r => r.status === 'success').length;
            
            summaryDiv.innerHTML = `
                <div class="debug-info">
                    <strong>Tests r√©ussis: ${successCount} / ${totalTests}</strong><br>
                    <strong>R√©sultats d√©taill√©s:</strong><br>
                    ${JSON.stringify(testResults, null, 2)}
                </div>
            `;
            
            // Colorer la section r√©sum√©
            const resultsSection = document.getElementById('results-summary');
            if (successCount === totalTests && totalTests > 0) {
                resultsSection.className = 'test-section success';
            } else if (successCount === 0) {
                resultsSection.className = 'test-section error';
            } else {
                resultsSection.className = 'test-section warning';
            }
        }
        
        // Lancer tous les tests
        window.onload = function() {
            console.log('üß™ D√©marrage des tests d\'images...');
            
            // D√©lai pour permettre aux images de se charger
            setTimeout(() => {
                testFetch();
                testAbsoluteURL();
                testServerInfo();
            }, 1000);
        };
    </script>
</body>
</html>
